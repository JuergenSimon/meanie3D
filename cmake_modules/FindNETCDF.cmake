IF (CMAKE_SYSTEM_NAME MATCHES Linux)
    MESSAGE(STATUS "looking for libnetcdf and libnetcdf_c++4 here: ${LPATH}")
    FIND_PATH(NETCDF_INCLUDE_DIR netcdf.h PATHS /usr/include /usr/local/include /opt/local/include) 
    FIND_LIBRARY(NETCDF NAMES netcdf PATHS ${LPATH})
    FIND_LIBRARY(NETCDF_CPP NAMES netcdf_c++4 PATHS ${LPATH})
ELSE ()
    FIND_PATH(NETCDF_INCLUDE_DIR netcdf PATHS /usr/include /usr/local/include /opt/local/include)
    FIND_LIBRARY(NETCDF NAMES netcdf PATHS /usr/lib /usr/local/lib /opt/local/lib)
    FIND_LIBRARY(NETCDF_CPP NAMES netcdf_c++4 PATHS /usr/lib /usr/local/lib /opt/local/lib)
ENDIF ()

IF (NETCDF AND NETCDF_CPP)
   SET(NETCDF_LIBRARIES ${NETCDF_CPP} ${NETCDF})
ELSE ()
   SET(NETCDF_LIBRARIES "NOTFOUND")
ENDIF()

IF (NETCDF_INCLUDE_DIR AND NETCDF_LIBRARIES)
   SET(NETCDF_FOUND TRUE)
ENDIF (NETCDF_INCLUDE_DIR AND NETCDF_LIBRARIES)

IF (NOT NETCDF_FOUND AND NETCDF_FIND_REQUIRED)
   MESSAGE(FATAL_ERROR "Could not find NETCDF")
ENDIF ()

MARK_AS_ADVANCED(NETCDF_INCLUDE_DIR NETCDF_LIBRARIES)